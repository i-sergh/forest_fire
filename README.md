# forest_fire

Скрипт определения лесных пожаров на видео потоке по цвету 

Для завершения работы нажать `ESC` или закрыть терминал
<br>КРЕСТИК В ОКНЕ С ВИДЕО НЕ РАБОТАЕТ! ЭТО НОРМА

Для отображения/сокрытия слоя найденных объектов нажать `ПРОБЕЛ`

<hr>

# Используемые библиотеки
* opencv-python
* numpy

<hr>

# Руководство по настройке

ВСЕ УКАЗАННЫЕ ШАГИ ОПИСАНЫ ДЛЯ Windows10

Для работы скрипта требуется python 3.6 и выше

### Рекомендуется создаеие виртуальной среды 
(это не обязательный пункт. Если вы хотите его пропустить, переходите сразу к пункту <a href='#установка-библиотек'>установки библиотек</a>)

<br>Для создания вируальнй среды в терминале перейти в папку со скриптом 
```bash
cd path\to\file
```
создать виртуальное окружение
```bash
python -m venv ForestVenv
```
#### и активировать его
```bash
ForestVenv\Scripts\activate
```
в дальнейшем для работы скрипта нужно кажный раз <a href="#и-активировать-его">активировать</a> виртуальное окружение

### Установка библиотек

Для установки библиотек достаточно воспользоваться утилитой pip, указав `requirements.txt` 

```bash
pip install -r requirements.txt
```
Для работы требуется запускать `show_vids.py`
Если используется виртуальное окружение, то запуск производить через терминал
```bash
show_vids.py
```

# Документация

## show_vids.py

Основной скрипт.

Создает окно для отображения видеопотока

Для завершения работы нажать `ESC` или закрыть терминал

Для отображения/сокрытия слоя найденных объектов нажать `ПРОБЕЛ`

Путь до видеофайла указывается в строке
```python
PATH = 'samples/vids/1.mp4'
```

получение маски изображения и контуров происходит с момощью функции из <a href="#utils.py">utils.py</a> в строке
```python
mask, cont = get_center_of_ignition(frame)
```

## utils.py
Набор функций для работы основного скрипта

### _find_by_color
возвращает маску и контуры объекта определенного цвета.
Находит объекты по промежуткам в пространстве HSV

<br>Атрибуты
> `img`: np.uint8 
>>   массив изображения (цветовое пространство `BGR`)

> `low`: tuple 
>>   минимальное значение порога;  кортеж из 3-х значений, каждое значение в промежутке `0-255`

> `high`: tuple 
>> максимальное значение порога; кортеж из 3-х значений, каждое значение в промежутке `0-255`
>> каждое значение кортежа `high` должно быть больше соответствующего ему по индеску кортежа `low`
                        `high[0] > low[0]`, `high[1] > low[1]`, `high[2] > low[2]`
                        
<br><br>Возвращает:
>`img_mask`: np.uint8 
>>двумерный массив маски изображения

>`cont`: tuple of arrays 
>> возвращает кортеж контуров, найденных по цвету на изображении

### get_center_of_ignition
надстройка над <a href="#_find_by_color">_find_by_color</a>

<br>Атрибуты
> `img`: np.uint8 
>>   массив изображения (цветовое пространство `BGR`)

<br><br>Возвращает:
>`img_mask`: np.uint8 
>>двумерный массив маски изображения

>`cont`: tuple of arrays 
>> возвращает кортеж контуров, найденных по цвету на изображении
